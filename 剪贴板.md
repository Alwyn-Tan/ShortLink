    @Override
    public void createGroupByGroupName(String groupname, String username) {
        if (username == null) {
            throw new ServiceException(USER_LOGIN_ERROR);
        }

        RLock lock = redissonClient.getLock(LOCK_GROUP_ADD_KEY + username);
        lock.lock();
        if (!lock.tryLock()) {
            throw new ClientException(SERVICE_ERROR);
        }
        try {
            int tryCount = 0;
            while (tryCount <= MAX_RETRY_LIMIT) {
                String gid = RandomGenerator.generateRandom();
                if (!gidBloomFilter.contains(gid)) {
                    GroupDO groupDO = GroupDO.builder().gid(gid).groupname(groupname).username(username).sortOrder(0).build();
                    baseMapper.insert(BeanUtil.toBean(groupDO, GroupDO.class));
                    gidBloomFilter.add(gid);
                    break;
                }
                tryCount++;
            }
        } catch (DuplicateKeyException ex) {
            throw new ClientException(GROUP_NAME_EXIST_ERROR);
        } finally {
            lock.unlock();
        }
    }
